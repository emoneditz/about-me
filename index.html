<!DOCTYPE html>
<html lang="en" class="scroll-smooth dark"> <!-- Default to dark mode -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emon Lab</title> <!-- Title set to Emon Lab -->
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Custom CSS variables for dark/light mode */
        :root {
            --bg-color-light: #f0f2f5;
            --text-color-light: #e0e7ff;
            --card-bg-light: rgba(255, 255, 255, 0.08);
            --border-color-light: rgba(255, 255, 255, 0.05);
            --header-bg-light: rgba(255, 255, 255, 0.05);
            --primary-glow: #00eaff;
            --secondary-glow: #e0aaff;
            --gradient-start: #00c6ff;
            --gradient-end: #a78bfa;
            --modal-bg-light: rgba(255, 255, 255, 0.1);
            --chat-bubble-user-light: rgba(0, 198, 255, 0.2);
            --chat-bubble-ai-light: rgba(167, 139, 250, 0.2);
        }

        html.dark {
            --bg-color-dark: #1a202c;
            --text-color-dark: #e2e8f0;
            --card-bg-dark: rgba(26, 32, 44, 0.08);
            --border-color-dark: rgba(255, 255, 255, 0.03);
            --header-bg-dark: rgba(26, 32, 44, 0.05);
            --primary-glow: #8affd1;
            --secondary-glow: #c4b5fd;
            --gradient-start: #8affd1;
            --gradient-end: #c4b5fd;
            --modal-bg-dark: rgba(26, 32, 44, 0.1);
            --chat-bubble-user-dark: rgba(138, 255, 209, 0.2);
            --chat-bubble-ai-dark: rgba(196, 181, 253, 0.2);
        }

        /* Base styles */
        body {
            font-family: 'Inter', sans-serif;
            color: var(--text-color-dark); /* Default to dark theme text color */
            transition: color 0.3s ease;
            overflow-x: hidden;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            /* Background handled by video and overlay now */
            background-color: transparent;
        }

        html.dark body {
            color: var(--text-color-dark);
        }

        /* Glassy Effect Mixin */
        .glassy {
            backdrop-filter: blur(35px) saturate(180%);
            -webkit-backdrop-filter: blur(35px) saturate(180%);
            background-color: var(--card-bg-dark);
            border: 1px solid var(--border-color-dark);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4), inset 0 0 15px rgba(255, 255, 255, 0.02);
            border-radius: 20px;
            transition: all 0.4s ease-out;
        }

        html.dark .glassy {
            background-color: var(--card-bg-dark);
            border: 1px solid var(--border-color-dark);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4), inset 0 0 15px rgba(255, 255, 255, 0.02);
        }

        /* Header Specific Styles */
        .header-glassy {
            backdrop-filter: blur(40px) saturate(180%);
            -webkit-backdrop-filter: blur(40px) saturate(180%);
            background-color: var(--header-bg-dark);
            border-bottom: 1px solid var(--border-color-dark);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        html.dark .header-glassy {
            background-color: var(--header-bg-dark);
            border-bottom: 1px solid var(--border-color-dark);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        /* Preloader Styles */
        #preloader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000000;
            display: flex;
            flex-direction: column; /* Allow stacking icon and text */
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.7s ease-out;
            cursor: pointer; /* Indicate it's clickable */
            color: white; /* Text color for preloader */
            font-size: 1.5rem;
            font-weight: bold;
            text-align: center;
        }

        #preloader .spinner-container {
            position: relative;
            width: 80px;
            height: 80px;
            margin-bottom: 2rem; /* Space between spinner and text */
        }

        #preloader .spinner {
            position: absolute;
            border-radius: 50%;
            animation: spin 1.5s linear infinite;
        }

        #preloader .spinner:nth-child(1) {
            width: 80px;
            height: 80px;
            border: 8px solid rgba(255, 255, 255, 0.1);
            border-top: 8px solid var(--primary-glow);
            box-shadow: 0 0 25px var(--primary-glow);
        }

        #preloader .spinner:nth-child(2) {
            width: 60px;
            height: 60px;
            border: 6px solid rgba(255, 255, 255, 0.1);
            border-top: 6px solid var(--secondary-glow);
            animation-delay: 0.2s;
            box-shadow: 0 0 20px var(--secondary-glow);
            top: 10px;
            left: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        #preloader .click-prompt {
            opacity: 0; /* Initially hidden */
            transition: opacity 0.5s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }

        #preloader .click-prompt.active {
            opacity: 1; /* Visible after spinner */
        }

        #preloader .click-prompt i {
            font-size: 3rem; /* Icon size */
            color: var(--primary-glow);
        }

        /* Background Video Styles */
        #background-video {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover; /* Ensures the video covers the entire area */
            z-index: -2; /* Behind everything else */
            filter: brightness(0.7); /* Slightly dim the video */
        }

        /* Video Overlay for Blur and Tint */
        #video-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.2); /* 20% opaque black tint */
            backdrop-filter: blur(2px); /* Subtle blur effect - REDUCED BLUR */
            -webkit-backdrop-filter: blur(2px); /* REDUCED BLUR */
            z-index: -1; /* Between video and content */
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.02);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--gradient-end);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--gradient-start);
        }

        /* Gradient for special text and buttons */
        .gradient-text {
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            background-image: linear-gradient(to right, var(--gradient-start), var(--gradient-end));
        }

        .gradient-button {
            background-image: linear-gradient(to right, var(--gradient-start), var(--gradient-end));
            box-shadow: 0 6px 20px rgba(0, 198, 255, 0.4);
            transition: all 0.3s ease;
            border: none;
        }
        .gradient-button:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 12px 30px rgba(0, 198, 255, 0.6);
        }
        html.dark .gradient-button {
            box-shadow: 0 6px 20px rgba(138, 255, 209, 0.4);
        }
        html.dark .gradient-button:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 12px 30px rgba(138, 255, 209, 0.6);
        }

        /* Link Card specific styles */
        .link-card {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            text-align: center;
            transition: transform 0.4s ease, box-shadow 0.4s ease, background-color 0.4s ease;
            min-height: 120px;
            overflow: hidden;
            opacity: 0; /* Initially hidden for fade-in effect */
            transform: translateY(20px); /* Initially slightly below for fade-in effect */
            transition: opacity 1.2s ease-out, transform 1.2s ease-out; /* Smoother transition */
            cursor: pointer; /* Indicate it's clickable */
        }

        .link-card.fade-in {
            opacity: 1;
            transform: translateY(0);
        }

        .link-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 20px;
            background: radial-gradient(circle at center, rgba(var(--primary-glow-rgb), 0.1) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.4s ease;
            z-index: 0;
        }

        .link-card:hover::before {
            opacity: 1;
        }

        .link-card:hover {
            transform: translateY(-8px) scale(1.01);
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.4);
        }

        /* Social icon within link card */
        .link-card .social-icon-in-card {
            font-size: 3rem; /* Adjust size as needed */
            margin-bottom: 1rem;
            color: var(--primary-glow); /* Example color, can be customized per icon */
            transition: color 0.3s ease, transform 0.4s ease; /* Added transform for spinning */
        }
        .link-card:hover .social-icon-in-card {
            color: var(--secondary-glow); /* Change color on hover */
            transform: rotateY(360deg); /* Spin effect */
        }

        /* Button container for slide effect - REMOVED GRADIENT */
        .link-card-button-container {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            padding: 1rem;
            display: flex;
            justify-content: center;
            align-items: center;
            /* background: linear-gradient(to top, rgba(0,0,0,0.8), rgba(0,0,0,0)); */ /* Removed this line */
            transform: translateY(100%); /* Start off-screen */
            opacity: 0;
            transition: transform 0.4s ease-out, opacity 0.4s ease-out;
            z-index: 3; /* Ensure button is above other content */
        }

        .link-card:hover .link-card-button-container {
            transform: translateY(0); /* Slide up */
            opacity: 1;
        }

        .link-card-button {
            padding: 0.75rem 1.5rem;
            border-radius: 9999px; /* Fully rounded */
            font-weight: 600;
            text-decoration: none;
            color: white;
            background-image: linear-gradient(to right, var(--gradient-start), var(--gradient-end));
            box-shadow: 0 4px 15px rgba(0, 198, 255, 0.3);
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: none;
        }

        .link-card-button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(0, 198, 255, 0.5);
        }
        html.dark .link-card-button {
            box-shadow: 0 4px 15px rgba(138, 255, 209, 0.3);
        }
        html.dark .link-card-button:hover {
            box-shadow: 0 6px 20px rgba(138, 255, 209, 0.5);
        }

        /* Adjust content positioning when button container is present */
        .link-card-content {
            padding-bottom: 3rem; /* Make space for the button */
        }


        /* General section padding and positioning */
        section {
            position: relative;
            z-index: 1;
            padding-top: 10rem;
            padding-bottom: 10rem;
        }

        /* Avatar glow */
        .avatar-glow {
            box-shadow: 0 0 30px rgba(138, 255, 209, 0.6), inset 0 0 15px rgba(138, 255, 209, 0.4);
            transition: all 0.4s ease;
        }
        html.dark .avatar-glow {
            box-shadow: 0 0 30px rgba(138, 255, 209, 0.6), inset 0 0 15px rgba(138, 255, 209, 0.4);
        }
        .avatar-glow:hover {
            transform: scale(1.05);
            box-shadow: 0 0 40px rgba(138, 255, 209, 0.8), inset 0 0 20px rgba(138, 255, 209, 0.6);
        }
        html.dark .avatar-glow:hover {
            box-shadow: 0 0 40px rgba(138, 255, 209, 0.8), inset 0 0 20px rgba(138, 255, 209, 0.6);
        }

        /* Define RGB values for JS use in radial gradients */
        .light-mode-rgb {
            --primary-glow-rgb: 0, 234, 255;
            --secondary-glow-rgb: 224, 170, 255;
        }
        .dark-mode-rgb {
            --primary-glow-rgb: 138, 255, 209;
            --secondary-glow-rgb: 196, 181, 253;
        }

        /* Gemini Assistant Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .gemini-modal {
            background-color: var(--modal-bg-dark);
            border: 1px solid var(--border-color-dark);
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.6), inset 0 0 20px rgba(255, 255, 255, 0.02);
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            height: 80%;
            max-height: 700px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transform: translateY(20px);
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
        }

        .modal-overlay.active .gemini-modal {
            transform: translateY(0);
            opacity: 1;
        }

        html.dark .gemini-modal {
            background-color: var(--modal-bg-dark);
            border: 1px solid var(--border-color-dark);
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.6), inset 0 0 20px rgba(255, 255, 255, 0.02);
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-color-dark);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-glow);
            letter-spacing: 0.05em;
        }

        html.dark .modal-header {
            border-bottom: 1px solid var(--border-color-dark);
        }

        .modal-close-button {
            background: none;
            border: none;
            font-size: 2rem;
            color: var(--text-color-dark);
            cursor: pointer;
            transition: color 0.3s ease, transform 0.2s ease;
        }
        .modal-close-button:hover {
            color: var(--primary-glow);
            transform: rotate(90deg);
        }
        html.dark .modal-close-button {
            color: var(--text-color-dark);
        }

        .chat-history {
            flex-grow: 1;
            padding: 1.5rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            scroll-behavior: smooth;
        }

        .chat-bubble {
            max-width: 80%;
            padding: 0.8rem 1.2rem;
            border-radius: 15px;
            line-height: 1.4;
            word-wrap: break-word;
        }

        .chat-bubble.user {
            align-self: flex-end;
            background-color: var(--chat-bubble-user-dark);
            border: 1px solid rgba(138, 255, 209, 0.3);
            color: var(--text-color-dark);
        }
        html.dark .chat-bubble.user {
            background-color: var(--chat-bubble-user-dark);
            border: 1px solid rgba(138, 255, 209, 0.3);
            color: var(--text-color-dark);
        }

        .chat-bubble.ai {
            align-self: flex-start;
            background-color: var(--chat-bubble-ai-dark);
            border: 1px solid rgba(196, 181, 253, 0.3);
            color: var(--text-color-dark);
        }
        html.dark .chat-bubble.ai {
            background-color: var(--chat-bubble-ai-dark);
            border: 1px solid rgba(196, 181, 253, 0.3);
            color: var(--text-color-dark);
        }

        .chat-input-area {
            padding: 1.5rem;
            border-top: 1px solid var(--border-color-dark);
            display: flex;
            gap: 1rem;
        }
        html.dark .chat-input-area {
            border-top: 1px solid var(--border-color-dark);
        }

        .chat-input {
            flex-grow: 1;
            padding: 0.8rem 1.2rem;
            border-radius: 10px;
            background-color: rgba(26, 32, 44, 0.1);
            border: 1px solid var(--border-color-dark);
            color: var(--text-color-dark);
            outline: none;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }
        .chat-input:focus {
            border-color: var(--primary-glow);
            box-shadow: 0 0 0 2px rgba(var(--primary-glow-rgb), 0.3);
        }
        html.dark .chat-input {
            background-color: rgba(26, 32, 44, 0.1);
            border: 1px solid var(--border-color-dark);
            color: var(--text-color-dark);
        }

        .chat-send-button {
            padding: 0.8rem 1.2rem;
            border-radius: 10px;
            background-image: linear-gradient(to right, var(--gradient-start), var(--gradient-end));
            color: white;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.3s ease;
        }
        .chat-send-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(var(--primary-glow-rgb), 0.4);
        }
        .chat-send-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .loading-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--primary-glow);
            font-style: italic;
            align-self: flex-start;
        }
        .loading-indicator .dot {
            width: 8px;
            height: 8px;
            background-color: var(--primary-glow);
            border-radius: 50%;
            animation: bounce 1.4s infinite ease-in-out;
        }
        .loading-indicator .dot:nth-child(2) { animation-delay: -0.3s; }
        .loading-indicator .dot:nth-child(3) { animation-delay: -0.6s; }

        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1.0); }
        }

        /* Custom Modal for "Link Not Added" */
        .custom-alert-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1001; /* Higher than Gemini modal */
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .custom-alert-modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .custom-alert-modal {
            background-color: var(--modal-bg-dark);
            border: 1px solid var(--border-color-dark);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5), inset 0 0 10px rgba(255, 255, 255, 0.01);
            border-radius: 15px;
            padding: 2rem;
            text-align: center;
            width: 90%;
            max-width: 400px;
            transform: translateY(-20px);
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
        }

        .custom-alert-modal-overlay.active .custom-alert-modal {
            transform: translateY(0);
            opacity: 1;
        }

        .custom-alert-modal h3 {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-glow);
            margin-bottom: 1rem;
        }

        .custom-alert-modal p {
            font-size: 1.1rem;
            color: var(--text-color-dark);
            margin-bottom: 1.5rem;
        }

        .custom-alert-modal-button {
            padding: 0.75rem 1.5rem;
            border-radius: 10px;
            background-image: linear-gradient(to right, var(--gradient-start), var(--gradient-end));
            color: white;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.3s ease;
        }
        .custom-alert-modal-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(var(--primary-glow-rgb), 0.4);
        }

        /* Password Modal Specific Styles */
        .password-modal {
            background-color: var(--modal-bg-dark);
            border: 1px solid var(--border-color-dark);
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.6), inset 0 0 20px rgba(255, 255, 255, 0.02);
            border-radius: 20px;
            padding: 2.5rem;
            text-align: center;
            width: 90%;
            max-width: 450px;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            transform: translateY(20px);
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
        }

        .modal-overlay.active .password-modal {
            transform: translateY(0);
            opacity: 1;
        }

        .password-input-wrapper {
            position: relative;
            width: 100%;
            display: flex;
            align-items: center;
        }

        .password-input {
            flex-grow: 1;
            padding: 1rem 1.25rem;
            padding-right: 3.5rem; /* Make space for the eye icon */
            border-radius: 10px;
            background-color: rgba(26, 32, 44, 0.1);
            border: 1px solid var(--border-color-dark);
            color: var(--text-color-dark);
            outline: none;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
            font-size: 1.1rem;
            text-align: center;
        }
        .password-input:focus {
            border-color: var(--primary-glow);
            box-shadow: 0 0 0 2px rgba(var(--primary-glow-rgb), 0.3);
        }
        .password-input::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }

        .toggle-password-visibility {
            position: absolute;
            right: 1.25rem;
            background: none;
            border: none;
            color: var(--text-color-dark);
            cursor: pointer;
            font-size: 1.2rem;
            transition: color 0.3s ease;
        }
        .toggle-password-visibility:hover {
            color: var(--primary-glow);
        }


        .password-submit-button {
            padding: 1rem 2rem;
            border-radius: 10px;
            background-image: linear-gradient(to right, var(--gradient-start), var(--gradient-end));
            color: white;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.3s ease;
            font-size: 1.2rem;
        }
        .password-submit-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(var(--primary-glow-rgb), 0.4);
        }
        .password-error {
            color: #ff4d4d; /* Bright red for error */
            font-size: 0.95rem;
            margin-top: -0.5rem;
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .password-error.active {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<body class="relative dark-mode-rgb">

    <!-- Background Video -->
    <video autoplay loop playsinline muted id="background-video">
        <!-- Source will be set dynamically by JavaScript -->
    </video>

    <!-- Video Overlay for Blur and Tint -->
    <div id="video-overlay"></div>

    <!-- Preloader / Click to Enter Screen -->
    <div id="preloader">
        <div class="spinner-container">
            <div class="spinner"></div>
            <div class="spinner"></div>
        </div>
        <div id="click-prompt" class="click-prompt">
            <i class="fas fa-hand-pointer"></i> <!-- Pointer icon -->
            <span>Click to Enter</span>
        </div>
    </div>

    <!-- Header -->
    <header id="main-header" class="fixed top-0 left-0 w-full z-50 py-6 px-8 md:px-16 header-glassy shadow-lg">
        <nav class="container mx-auto flex justify-between items-center">
            <div class="text-3xl font-extrabold gradient-text tracking-wider">Emon Lab</div>
            <div class="flex items-center space-x-6">
                <!-- Dark/Light Mode Toggle -->
                <button id="theme-toggle" class="p-3 rounded-full bg-gray-900 bg-opacity-30 text-gray-200 focus:outline-none focus:ring-2 focus:ring-primary-glow transition-colors duration-300">
                    <i class="fas fa-moon hidden dark:block text-2xl"></i>
                    <i class="fas fa-sun block dark:hidden text-2xl"></i>
                </button>
            </div>
        </nav>
    </header>

    <!-- Hero Section (for avatar and intro) -->
    <section id="hero" class="relative z-10 flex flex-col items-center justify-center min-h-screen pt-32 pb-16 px-4 w-full max-w-2xl mx-auto text-white">
        <img src="https://raw.githubusercontent.com/emoneditz/about-me/main/images%20(1)%20(1).jpeg" alt="Emon's Sovereign Avatar" class="rounded-full w-48 h-48 mx-auto object-cover mb-8 shadow-lg border-4 border-primary-glow avatar-glow">
        <h1 class="text-5xl md:text-7xl font-extrabold mb-4 leading-tight text-center">
            Welcome, I am <span class="gradient-text">Emon</span>
        </h1>
        <p class="text-2xl md:text-3xl max-w-2xl mx-auto text-gray-300 text-center font-medium mb-10">
            <span id="typed-text" class="font-bold gradient-text"></span>
        </p>
        <div class="flex flex-col sm:flex-row gap-4 items-center">
            <!-- "Ask me about Emon" button with robot icon -->
            <button id="ask-emon-button" class="inline-flex items-center justify-center px-8 py-4 rounded-full gradient-button text-white font-semibold shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300 ease-in-out text-xl tracking-wide">
                <i class="fas fa-robot mr-3"></i> Ask me about Emon
            </button>
            <!-- New "All my links" button -->
            <button id="all-links-button" class="inline-flex items-center justify-center px-8 py-4 rounded-full gradient-button text-white font-semibold shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300 ease-in-out text-xl tracking-wide">
                All my links <i class="fas fa-link ml-3"></i>
            </button>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="relative z-10 py-20 px-4 w-full max-w-4xl mx-auto">
        <div class="glassy p-10 text-center">
            <h2 class="text-4xl font-bold mb-8 gradient-text tracking-wide">About The Architect</h2>
            <p class="text-xl leading-relaxed text-gray-200 dark:text-gray-300 mb-10">
                Hey, it’s me Emon. I like to explore things. I don’t have much to say, but if you want to know anything about me, you can ask my AI right here or DM me on Facebook. Have a great day ♥️
            </p>
        </div>
    </section>

    <!-- Links Section (Main Content) - Now "Connect with Emon" -->
    <section id="links" class="relative z-10 py-20 px-4 w-full max-w-3xl mx-auto">
        <h2 class="text-4xl font-bold text-center mb-12 gradient-text tracking-wide">Connect with Emon</h2>
        <div class="grid grid-cols-1 gap-8">
            <!-- Customizable Link Card 1: Instagram -->
            <div class="link-card glassy">
                <div class="link-card-content">
                    <i class="fab fa-instagram social-icon-in-card text-pink-500"></i>
                    <h3>Instagram Profile</h3>
                    <p>My curated visual archives and moments.</p>
                </div>
                <div class="link-card-button-container">
                    <a href="https://www.instagram.com/emon_editz69?igsh=dXY3em5ndjFrczd5" target="_blank" rel="noopener noreferrer" class="link-card-button external-link-button">
                        Visit Profile <i class="fab fa-instagram ml-2"></i>
                    </a>
                </div>
            </div>

            <!-- Customizable Link Card 2: X (Twitter) -->
            <div class="link-card glassy">
                <div class="link-card-content">
                    <i class="fab fa-twitter social-icon-in-card text-blue-400"></i>
                    <h3>X (Twitter) Feed</h3>
                    <p>My real-time insights and digital dialogues.</p>
                </div>
                <div class="link-card-button-container">
                    <a href="https://x.com/emon3xprime" target="_blank" rel="noopener noreferrer" class="link-card-button external-link-button">
                        Visit Profile <i class="fab fa-twitter ml-2"></i>
                    </a>
                </div>
            </div>

            <!-- New Customizable Link Card: Pinterest -->
            <div class="link-card glassy">
                <div class="link-card-content">
                    <i class="fab fa-pinterest social-icon-in-card text-red-700"></i>
                    <h3>Pinterest Boards</h3>
                    <p>Explore my visual inspirations.</p>
                </div>
                <div class="link-card-button-container">
                    <a href="https://pin.it/7bdXGMclR" target="_blank" rel="noopener noreferrer" class="link-card-button external-link-button">
                        Visit Profile <i class="fab fa-pinterest ml-2"></i>
                    </a>
                </div>
            </div>

            <!-- Customizable Link Card for YouTube (REVERTED TO POP-UP) -->
            <div class="link-card glassy">
                <div class="link-card-content">
                    <i class="fab fa-youtube social-icon-in-card text-red-600"></i>
                    <h3>YouTube Channel</h3>
                    <p>My multimedia creations and explorations.</p>
                </div>
                <div class="link-card-button-container">
                    <button id="youtube-link-button" class="link-card-button">
                        Visit Channel <i class="fab fa-youtube ml-2"></i>
                    </button>
                </div>
            </div>

            <!-- Customizable Link Card 4: Facebook -->
            <div class="link-card glassy">
                <div class="link-card-content">
                    <i class="fab fa-facebook social-icon-in-card text-blue-600"></i>
                    <h3>Facebook Page</h3>
                    <p>Connect within my private digital network.</p>
                </div>
                <div class="link-card-button-container">
                    <a href="https://www.facebook.com/emoneditz69" target="_blank" rel="noopener noreferrer" class="link-card-button external-link-button">
                        Visit Profile <i class="fab fa-facebook ml-2"></i>
                    </a>
                </div>
            </div>

            <!-- Customizable Link Card 5: Discord -->
            <div class="link-card glassy">
                <div class="link-card-content">
                    <i class="fab fa-discord social-icon-in-card text-indigo-500"></i>
                    <h3>Discord Profile</h3>
                    <p>Connect with me on Discord.</p>
                </div>
                <div class="link-card-button-container">
                    <a href="https://discordapp.com/users/_emon_" target="_blank" rel="noopener noreferrer" class="link-card-button external-link-button">
                        Visit Profile <i class="fab fa-discord ml-2"></i>
                    </a>
                </div>
            </div>

            <!-- Customizable Link Card 7: Email -->
            <div class="link-card glassy">
                <div class="link-card-content">
                    <i class="fas fa-envelope social-icon-in-card text-gray-400"></i>
                    <h3>Direct Email</h3>
                    <p>Initiate a secure communication channel.</p>
                </div>
                <div class="link-card-button-container">
                    <a href="mailto:annihilation497837@gmail.com" class="link-card-button external-link-button">
                        Email Me <i class="fas fa-paper-plane ml-2"></i>
                    </a>
                </div>
            </div>

            <!-- NEW: Diary Link Card -->
            <div class="link-card glassy" id="diary-card">
                <div class="link-card-content">
                    <i class="fas fa-book-open social-icon-in-card text-yellow-500"></i>
                    <h3>Emon's Private Diary</h3>
                    <p>A glimpse into my thoughts and reflections.</p>
                </div>
                <div class="link-card-button-container">
                    <button id="open-diary-button" class="link-card-button">
                        Open Diary <i class="fas fa-lock ml-2"></i>
                    </button>
                </div>
            </div>

        </div>
    </section>

    <!-- Footer -->
    <footer class="relative z-10 py-10 px-4 text-center bg-transparent text-gray-500 transition-colors duration-300 mt-auto">
        <div class="container mx-auto">
            <p class="text-lg">© 2025 Emon. All Rights Reserved.</p>
        </div>
    </footer>

    <!-- Gemini Assistant Modal -->
    <div id="gemini-modal-overlay" class="modal-overlay">
        <div class="gemini-modal">
            <div class="modal-header">
                <span><i class="fas fa-robot mr-2"></i> Your Digital Assistant</span>
                <button id="modal-close-button" class="modal-close-button">×</button>
            </div>
            <div id="chat-history" class="chat-history">
                <!-- Chat messages will be appended here -->
            </div>
            <div class="chat-input-area">
                <input type="text" id="chat-input" class="chat-input" placeholder="How may I assist you, Sovereign?">
                <button id="chat-send-button" class="chat-send-button">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Custom Alert Modal for "Link Not Added" (Re-enabled for YouTube) -->
    <div id="custom-alert-modal-overlay" class="custom-alert-modal-overlay">
        <div class="custom-alert-modal">
            <h3>Link Not Added!</h3>
            <p>Emon's YouTube channel link is not available yet. Please check back later!</p>
            <button id="custom-alert-close-button" class="custom-alert-modal-button">Okay</button>
        </div>
    </div>

    <!-- NEW: Diary Password Modal -->
    <div id="diary-password-modal-overlay" class="modal-overlay">
        <div class="password-modal">
            <div class="modal-header">
                <span><i class="fas fa-lock mr-2"></i> Private Diary</span>
                <button id="password-modal-close-button" class="modal-close-button">×</button>
            </div>
            <p class="text-gray-300">Enter the password to access Emon's private diary:</p>
            <div class="password-input-wrapper">
                <input type="password" id="diary-password-input" class="password-input" placeholder="Enter password">
                <button type="button" id="toggle-password-visibility" class="toggle-password-visibility">
                    <i class="fas fa-eye"></i>
                </button>
            </div>
            <p id="password-error-message" class="password-error">Incorrect password. Please try again.</p>
            <button id="password-submit-button" class="password-submit-button">
                Unlock <i class="fas fa-unlock ml-2"></i>
            </button>
        </div>
    </div>

    <!-- Typed.js CDN -->
    <script src="https://unpkg.com/typed.js@2.1.0/dist/typed.umd.js"></script>

    <script>
        // Set initial RGB values for CSS variables based on current theme
        function setRgbVariables(isDarkMode) {
            const body = document.body;
            if (isDarkMode) {
                body.classList.remove('light-mode-rgb');
                body.classList.add('dark-mode-rgb');
            } else {
                body.classList.remove('dark-mode-rgb');
                body.classList.add('light-mode-rgb');
            }
        }

        // --- Video Background Logic ---
        const videoUrls = [
            "https://raw.githubusercontent.com/emoneditz/about-me/main/a.mp4",
            "https://raw.githubusercontent.com/emoneditz/about-me/main/Space _ 4k(720P_HD).mp4"
        ];
        const randomVideoUrl = videoUrls[Math.floor(Math.random() * videoUrls.length)];
        const backgroundVideo = document.getElementById('background-video');
        if (backgroundVideo) {
            const sourceElement = document.createElement('source');
            sourceElement.src = randomVideoUrl;
            sourceElement.type = "video/mp4"; // Assuming both are MP4
            backgroundVideo.appendChild(sourceElement);
            backgroundVideo.load(); // Load the new source
        }

        // Preloader Logic
        window.addEventListener('load', () => {
            const preloader = document.getElementById('preloader');
            const spinnerContainer = preloader.querySelector('.spinner-container');
            const clickPrompt = document.getElementById('click-prompt');

            // Hide spinner and show "Click to Enter" after a short delay
            setTimeout(() => {
                if (spinnerContainer) {
                    spinnerContainer.style.display = 'none'; // Hide the spinner
                }
                if (clickPrompt) {
                    clickPrompt.classList.add('active'); // Show the click prompt
                }
            }, 1500); // Adjust delay as needed for spinner animation

            // Handle click on preloader to enter and unmute
            preloader.addEventListener('click', () => {
                if (backgroundVideo && backgroundVideo.muted) {
                    backgroundVideo.muted = false;
                    backgroundVideo.play().catch(error => console.error("Video play on unmute failed:", error));
                }
                // Fade out preloader
                preloader.style.opacity = '0';
                setTimeout(() => {
                    preloader.style.display = 'none';
                }, 700); // Match CSS transition duration
            }, { once: true }); // Ensure this click listener only fires once

            // Attempt to play video after preloader, it will be muted by default
            if (backgroundVideo) {
                backgroundVideo.play().catch(error => console.error("Video autoplay failed (likely due to sound policy, but muted):", error));
            }
        });

        // Header Sticky and Blur Effect
        const header = document.getElementById('main-header');
        window.addEventListener('scroll', () => {
            if (window.scrollY > 50) {
                header.classList.add('shadow-xl');
            } else {
                header.classList.remove('shadow-xl');
            }
        });

        // Typed.js Initialization
        document.addEventListener('DOMContentLoaded', () => {
            const typedTextElement = document.getElementById('typed-text');
            if (typedTextElement) {
                new Typed(typedTextElement, {
                    strings: ["a student", "a tech explorer", "a human kind"],
                    typeSpeed: 60,
                    backSpeed: 30,
                    loop: true,
                    showCursor: true,
                    cursorChar: '█',
                    autoInsertCss: true,
                });
            }
        });

        // Dark/Light Mode Toggle
        const themeToggle = document.getElementById('theme-toggle');
        const htmlElement = document.documentElement;

        // Set initial theme to dark by default
        htmlElement.classList.add('dark');
        setRgbVariables(true);
        localStorage.setItem('theme', 'dark');

        themeToggle.addEventListener('click', () => {
            htmlElement.classList.toggle('dark');
            const isDarkMode = htmlElement.classList.contains('dark');
            setRgbVariables(isDarkMode);
            if (isDarkMode) {
                localStorage.setItem('theme', 'dark');
            } else {
                localStorage.setItem('theme', 'light');
            }
        });

        /* Gemini Assistant Functionality */
        const askEmonButton = document.getElementById('ask-emon-button');
        const allLinksButton = document.getElementById('all-links-button');
        const geminiModalOverlay = document.getElementById('gemini-modal-overlay');
        const modalCloseButton = document.getElementById('modal-close-button');
        const chatHistoryDiv = document.getElementById('chat-history');
        const chatInput = document.getElementById('chat-input');
        const chatSendButton = document.getElementById('chat-send-button');

        let chatHistory = []; // Stores the conversation history for the API

        // Emon's details - UPDATED FOR CLARITY AND API USE
        const emonDetails = {
            name: "Emon",
            roles: "a student, a tech explorer, a human kind",
            relationshipStatus: "Emon does not currently have a girlfriend, as he is still a student. He finds that relationships often lead to heartbreak. He is loyal to his future Queen and maintains distance from girls for this reason.",
            birthday: "Emon's birthday is on the 3rd day of any month.",
            girlType: "Emon is looking for a partner with no ex-partners and cooking skills. He does not care about physical appearance or skin tone.",
            hobbies: "Emon likes to play video games, especially shooting games. His favorite game is Free Fire. He also enjoys video editing.",
            smoking: "Emon is not engaged with any smoking or related things.",
            contact: "You can contact Emon by asking his AI here or by direct messaging him on Facebook.",
            crushStatus: "Emon does not have any crush online or in real life. In online interactions, he believes people are different offline and online. In offline settings, he always stays away from girls because a heartbreak could ruin his life.",
            brothers: "Emon has two brothers. Rimon is 2.8 years older than him, and Saimon is 6 years younger than him.",
            dreamsAndWishes: "Emon's biggest dreams and wishes are: 1. To see his family’s real smile, not the fake one, but the one from the heart. 2. For his family's lasting health and safety. 3. To be the reason behind his family's true happiness.",
            favoriteFood: "Emon's favorite food is cow meat Biriyani.",
            origin: "Milky Way Galaxy, Earth, Bangladesh",
            collabInterest: "Emon is not interested in any collaborations, promotions, or sponsorships."
        };

        // Function to add a message to the chat history UI
        function addMessageToChat(message, sender) {
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('chat-bubble', sender);
            messageDiv.textContent = message;
            chatHistoryDiv.appendChild(messageDiv);
            chatHistoryDiv.scrollTop = chatHistoryDiv.scrollHeight;
        }

        // Define the dynamic identity responses for the AI itself
        const aiIdentityResponses = [
            `Hello Mr/Miss, I am a digital assistant created by ${emonDetails.name}. If you want to know anything about him like - hobbies, preferences, or want to chat with me, just ask.`,
            `Greetings. I am a digital assistant, brought into existence by ${emonDetails.name}. Feel free to inquire about his interests, preferences, or engage in conversation.`,
            `You are speaking with a digital assistant, designed by ${emonDetails.name}. I can provide insights into his passions, preferences, or simply chat with you.`,
            `My core programming was established by ${emonDetails.name}. Should you wish to learn about his hobbies, preferences, or just converse, I am here to assist.`
        ];

        // Function to get a random AI identity response
        function getRandomAiIdentityResponse() {
            const randomIndex = Math.floor(Math.random() * aiIdentityResponses.length);
            return aiIdentityResponses[randomIndex];
        }

        // Handle "Ask me about Emon" button click (central AI trigger)
        askEmonButton.addEventListener('click', () => {
            geminiModalOverlay.classList.add('active');
            chatHistoryDiv.innerHTML = ''; // Clear previous chat
            chatHistory = []; // Clear chat history array

            // AI immediately provides its Emon-centric introduction
            const initialGreeting = getRandomAiIdentityResponse();
            addMessageToChat(initialGreeting, 'ai');
            chatHistory.push({ role: "model", parts: [{ text: initialGreeting }] });

            chatInput.focus();
        });

        // Handle "All my links" button click
        allLinksButton.addEventListener('click', () => {
            document.getElementById('links').scrollIntoView({ behavior: 'smooth' });
        });

        // Close Gemini Modal
        modalCloseButton.addEventListener('click', () => {
            geminiModalOverlay.classList.remove('active');
        });

        /* Custom Alert Modal Functionality */
        const customAlertModalOverlay = document.getElementById('custom-alert-modal-overlay');
        const customAlertCloseButton = document.getElementById('custom-alert-close-button');

        function showCustomAlert() {
            customAlertModalOverlay.classList.add('active');
        }

        customAlertCloseButton.addEventListener('click', () => {
            customAlertModalOverlay.classList.remove('active');
        });

        // Function to check if an element is fully in viewport
        function isElementFullyInViewport(el) {
            const rect = el.getBoundingClientRect();
            const viewportHeight = window.innerHeight || document.documentElement.clientHeight;
            const viewportWidth = window.innerWidth || document.documentElement.clientWidth;

            const isFullyVisible = (
                rect.top >= 0 &&
                rect.left >= 0 &&
                rect.bottom <= viewportHeight &&
                rect.right <= viewportWidth
            );
            return isFullyVisible;
        }

        // Function to handle the action after potential scrolling
        function handleCardAction(event, card) {
            const clickedButton = event.target.closest('.link-card-button');

            if (clickedButton) {
                if (clickedButton.id === 'open-diary-button') {
                    showDiaryPasswordModal();
                } else if (clickedButton.id === 'youtube-link-button') {
                    showCustomAlert();
                } else if (clickedButton.classList.contains('external-link-button')) {
                    const href = clickedButton.getAttribute('href');
                    if (href) {
                        window.open(href, '_blank');
                    }
                }
            } else {
                // If the click was on the card but not a specific button,
                // and the card is not fully in viewport, scroll it.
                // If it is fully in viewport, no action needed for a general card click.
            }
        }

        // UNIVERSAL Link Card Click Handler for scrolling and opening links/alerts/modals
        document.querySelectorAll('.link-card').forEach(card => {
            card.addEventListener('click', (event) => {
                const shouldScroll = !isElementFullyInViewport(card);

                if (shouldScroll) {
                    card.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    // Add a small delay to allow scroll to complete before potential link opening
                    setTimeout(() => handleCardAction(event, card), 400);
                } else {
                    // If already in view, execute action immediately
                    handleCardAction(event, card);
                }
            });
        });


        // Keywords that trigger specific Emon details via Gemini API
        const emonSpecificKeywords = [
            "girlfriend", "relationship", "single", "married", "partner", "love life", "gf",
            "birthday", "birth date", "born", "bday",
            "type in girl", "ideal girl", "girl type", "preferences in girl", "what kind of girl", "dream girl", "flair skin", "fair skin", "looking for in a partner",
            "contact", "reach out", "get in touch", "how to contact me", "how can I contact", "contact emon", "dm me",
            "hobbies", "games", "favorite game", "free fire", "shooting games", "what does he like to do", "video editing",
            "smoking", "smoke", "cigarettes", "vape", "drugs",
            "crush", "have a crush", "crushes", "love interest", "like anyone", "liked anyone",
            "brother", "brothers", "family", "siblings", "rimon", "saimon",
            "dream", "dreams", "wish", "wishes", "goals", "aspirations", "future",
            "food", "favorite food", "eat", "eating", "cow meat", "biriyani", "biryani",
            "origin", "where are you from", "where is emon from",
            "collab", "collaboration", "promote", "promotion", "sponsor", "sponsorship", "business", "work with"
        ];

        // Send Message to Gemini API
        async function sendMessageToGemini() {
            const prompt = chatInput.value.trim();
            if (prompt === '') return;

            addMessageToChat(prompt, 'user');
            const lowerCasePrompt = prompt.toLowerCase();

            chatInput.value = '';
            chatSendButton.disabled = true;

            const loadingIndicator = document.createElement('div');
            loadingIndicator.classList.add('loading-indicator');
            loadingIndicator.innerHTML = '<span>AI is thinking</span><span class="dot"></span><span class="dot"></span><span class="dot"></span>';
            chatHistoryDiv.appendChild(loadingIndicator);
            chatHistoryDiv.scrollTop = chatHistoryDiv.scrollHeight;

            let geminiApiContents = [];

            // Handle AI identity questions first (local response, no Gemini call for this)
            const aiIdentityKeywords = ["who are you", "what are you", "your creator", "who made you", "where are you from", "who created you", "your origin", "about you"];
            if (aiIdentityKeywords.some(keyword => lowerCasePrompt.includes(keyword))) {
                loadingIndicator.remove();
                const aiResponse = getRandomAiIdentityResponse();
                addMessageToChat(aiResponse, 'ai');
                chatHistory.push({ role: "model", parts: [{ text: aiResponse }] });
                chatSendButton.disabled = false;
                chatInput.focus();
                return;
            }

            // Check if the prompt contains any Emon-specific keywords
            const isEmonSpecificQuestion = emonSpecificKeywords.some(keyword => lowerCasePrompt.includes(keyword));

            // Construct the comprehensive facts about Emon for the AI
            const allEmonFacts = `
Emon's relationship status is: "${emonDetails.relationshipStatus}"
Emon's birthday is: "${emonDetails.birthday}"
Emon's ideal partner has these qualities: "${emonDetails.girlType}"
Emon's hobbies include: "${emonDetails.hobbies}"
Regarding smoking: "${emonDetails.smoking}"
You can contact Emon via: "${emonDetails.contact}"
Emon's crush status is: "${emonDetails.crushStatus}"
Emon's brothers: "${emonDetails.brothers}"
Emon's biggest dreams and wishes: "${emonDetails.dreamsAndWishes}"
Emon's favorite food: "${emonDetails.favoriteFood}"
Emon's origin is: "${emonDetails.origin}"
Emon's interest in collaborations/promotions/sponsorships: "${emonDetails.collabInterest}"
`;

            if (isEmonSpecificQuestion) {
                // If it's an Emon-specific question, provide the facts and a strict instruction
                const emonSpecificInstruction = `You are a digital assistant for Emon. Your sole purpose for this specific query is to provide a direct, concise, and factual answer based *only* on the provided details about Emon. **You MUST NOT deviate from the provided facts. You MUST NOT ask for clarification. You MUST NOT mention privacy or personal boundaries. You MUST NOT rephrase or interpret the facts beyond what is necessary to directly answer the question.** If the exact information is not explicitly provided in these facts, state ONLY "I don't have that specific detail about Emon." Do not invent details or refer to yourself as a large language model.

Here are the facts about Emon:
${allEmonFacts}

User's question: "${prompt}"

Your direct answer:`;
                geminiApiContents.push({ role: "user", parts: [{ text: emonSpecificInstruction }] });
            } else {
                // For general questions or conversational cues, use a general instruction
                const generalAiInstruction = `You are a helpful AI assistant. Respond conversationally and naturally. If the user makes a general remark or asks a general question, acknowledge it briefly and perhaps ask an open-ended follow-up question to continue the conversation. **Do NOT volunteer specific facts about Emon, especially personal or romantic details, unless explicitly asked about those specific details.**`;
                geminiApiContents.push({ role: "user", parts: [{ text: generalAiInstruction }] });
                geminiApiContents = geminiApiContents.concat(chatHistory.map(msg => ({ role: msg.role, parts: msg.parts })));
                geminiApiContents.push({ role: "user", parts: [{ text: prompt }] });
            }

            try {
                const apiKey = "AIzaSyAyKPocbERL1XmrzTkR73306yAwpIPdxPY"; // YOUR PROVIDED GEMINI API KEY
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: geminiApiContents })
                });

                const result = await response.json();

                let aiResponse = "My apologies, I could not process that request at this moment. Please try again.";
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    aiResponse = result.candidates[0].content.parts[0].text;
                } else {
                    console.error("Gemini API response structure unexpected:", result);
                    aiResponse = "I'm sorry, I couldn't find a clear answer to that. Perhaps I can help with something else?";
                }

                loadingIndicator.remove();
                addMessageToChat(aiResponse, 'ai');
                chatHistory.push({ role: "model", parts: [{ text: aiResponse }] });
                chatSendButton.disabled = false;
                chatInput.focus();

            } catch (error) {
                console.error("Error communicating with Gemini API:", error);
                loadingIndicator.remove();
                addMessageToChat("An error occurred while connecting to the assistant. Please check your network.", 'ai');
                chatSendButton.disabled = false;
                chatInput.focus();
            }
        }

        // Event listeners for sending messages
        chatSendButton.addEventListener('click', sendMessageToGemini);
        chatInput.addEventListener('keypress', (event) => {
            if (event.key === 'Enter') {
                sendMessageToGemini();
            }
        });

        // Intersection Observer for fade-in animation
        const linkCards = document.querySelectorAll('.link-card');
        const observerOptions = {
            root: null, // viewport
            rootMargin: '0px',
            threshold: 0.1 // 10% of the card must be visible
        };

        const observer = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('fade-in');
                    observer.unobserve(entry.target); // Stop observing once it's faded in
                }
            });
        }, observerOptions);

        linkCards.forEach(card => {
            observer.observe(card);
        });

        /* Diary Password Modal Functionality */
        const diaryPasswordModalOverlay = document.getElementById('diary-password-modal-overlay');
        const passwordModalCloseButton = document.getElementById('password-modal-close-button');
        const diaryPasswordInput = document.getElementById('diary-password-input');
        const passwordSubmitButton = document.getElementById('password-submit-button');
        const passwordErrorMessage = document.getElementById('password-error-message');
        const togglePasswordVisibilityButton = document.getElementById('toggle-password-visibility');

        // Function to normalize password input for comparison (only check for "lamiya")
        function normalizePassword(input) {
            return input.toLowerCase(); // Convert to lowercase
        }

        const diaryRedirectUrl = "https://emoneditz.github.io/27-06-2025-Lamiya/";

        function showDiaryPasswordModal() {
            diaryPasswordModalOverlay.classList.add('active');
            diaryPasswordInput.value = ''; // Clear input on open
            passwordErrorMessage.classList.remove('active'); // Hide error message
            diaryPasswordInput.focus(); // Focus on the input field
        }

        function hideDiaryPasswordModal() {
            diaryPasswordModalOverlay.classList.remove('active');
            diaryPasswordInput.value = ''; // Clear input on close
            passwordErrorMessage.classList.remove('active'); // Hide error
        }

        passwordModalCloseButton.addEventListener('click', hideDiaryPasswordModal);

        passwordSubmitButton.addEventListener('click', () => {
            const enteredPassword = normalizePassword(diaryPasswordInput.value);

            // Check if the entered password contains "lamiya"
            if (enteredPassword.includes("lamiya")) {
                hideDiaryPasswordModal();
                window.open(diaryRedirectUrl, '_blank'); // Open diary page in new tab
            } else {
                passwordErrorMessage.classList.add('active'); // Show error message
                diaryPasswordInput.value = ''; // Clear input for retry
                diaryPasswordInput.focus();
            }
        });

        diaryPasswordInput.addEventListener('keypress', (event) => {
            if (event.key === 'Enter') {
                passwordSubmitButton.click(); // Trigger button click on Enter
            }
        });

        // Toggle password visibility
        if (togglePasswordVisibilityButton && diaryPasswordInput) {
            togglePasswordVisibilityButton.addEventListener('click', () => {
                const type = diaryPasswordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                diaryPasswordInput.setAttribute('type', type);

                // Toggle eye icon
                togglePasswordVisibilityButton.querySelector('i').classList.toggle('fa-eye');
                togglePasswordVisibilityButton.querySelector('i').classList.toggle('fa-eye-slash');
            });
        }
    </script>
</body>
</html>
